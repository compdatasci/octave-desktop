os: linux
language: python
services: docker

env: OCTAVE_VERSION=4.2.1

before_script:
  - git clone --depth=1 https://$GIT_TOKEN@github.com/xmjiao/ci-util.git 2> /dev/null

script:
  - './ci-util/build-docker.sh : :${OCTAVE_VERSION},latest --build-arg OCTAVE_VERSION=$OCTAVE_VERSION &&
     ./octave_desktop.py -d -n && docker stop $(docker ps -q) &&
     ./octave_jupyter.py -d -n && docker stop $(docker ps -q) &&
     ./ci-util/trigger-via-api.sh'
